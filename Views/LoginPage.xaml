<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:ViewModel="clr-namespace:MauiFrontend.ViewModels"
             xmlns:converters="clr-namespace:MauiFrontend.Converters"
             x:DataType="ViewModel:LoginViewModel"
             x:Class="MauiFrontend.Views.LoginPage"
             Title="LoginPage"
             BackgroundColor="#F5F5F5"
             Shell.NavBarIsVisible="False">

    <ContentPage.Resources>
        <ResourceDictionary>
            <converters:InvertedBoolConverter x:Key="InvertedBoolConverter" />
        </ResourceDictionary>
    </ContentPage.Resources>

    <Grid>
        <ScrollView>
            <Grid x:Name="MainGrid">
                <!-- Layout cho chế độ dọc (Portrait) -->
                <VerticalStackLayout x:Name="PortraitLayout"
                                     Padding="30"
                                     Spacing="20"
                                     VerticalOptions="Center">

                    <!-- Logo -->
                    <Image Source="dotnet_bot.png"
                           HeightRequest="120"
                           WidthRequest="120"
                           Aspect="AspectFit"
                           Margin="0,0,0,10" />

                    <!-- Slogan -->
                    <Label Text="Chào mừng bạn trở lại!"
                           FontSize="24"
                           FontAttributes="Bold"
                           HorizontalOptions="Center"
                           TextColor="#2C3E50" />

                    <Label Text="Đăng nhập để tiếp tục"
                           FontSize="14"
                           HorizontalOptions="Center"
                           TextColor="#7F8C8D"
                           Margin="0,0,0,20" />

                    <!-- Form đăng nhập -->
                    <Border BackgroundColor="White"
                            StrokeThickness="0"
                            Padding="20"
                            Shadow="{Shadow Brush=#40000000, Offset='0,2', Radius=8, Opacity=0.3}">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="15" />
                        </Border.StrokeShape>

                        <VerticalStackLayout Spacing="15">
                            <!-- Email/Username -->
                            <Label Text="Email hoặc Tên đăng nhập"
                                   FontSize="14"
                                   TextColor="#2C3E50" />

                            <Border Stroke="#E0E0E0"
                                    StrokeThickness="1"
                                    Padding="12,8"
                                    BackgroundColor="White">
                                <Border.StrokeShape>
                                    <RoundRectangle CornerRadius="10" />
                                </Border.StrokeShape>
                                <Entry Placeholder="Nhập email hoặc tên đăng nhập"
                                       PlaceholderColor="#BDC3C7"
                                       TextColor="#2C3E50"
                                       Keyboard="Email"
                                       BackgroundColor="Transparent"
                                       Text="{Binding Email, Mode=TwoWay}" />
                            </Border>

                            <!-- Password -->
                            <Label Text="Mật khẩu"
                                   FontSize="14"
                                   TextColor="#2C3E50"
                                   Margin="0,10,0,0" />

                            <Border Stroke="#E0E0E0"
                                    StrokeThickness="1"
                                    Padding="12,8"
                                    BackgroundColor="White">
                                <Border.StrokeShape>
                                    <RoundRectangle CornerRadius="10" />
                                </Border.StrokeShape>
                                <Entry Placeholder="Nhập mật khẩu"
                                       PlaceholderColor="#BDC3C7"
                                       TextColor="#2C3E50"
                                       IsPassword="True"
                                       BackgroundColor="Transparent"
                                       Text="{Binding Password, Mode=TwoWay}" />
                            </Border>

                            <!-- Quên mật khẩu -->
                            <Label 
                                Text="Quên mật khẩu?"
                                FontSize="12"
                                TextColor="#3498DB"
                                HorizontalOptions="End"
                                Margin="0,5,0,0">
                                <Label.GestureRecognizers>
                                    <TapGestureRecognizer Command="{Binding ForgotPasswordCommand}" />
                                </Label.GestureRecognizers>
                            </Label>

                        </VerticalStackLayout>
                    </Border>

                    <!-- Nút Đăng nhập -->
                    <Button Text="Đăng nhập"
                            BackgroundColor="#3498DB"
                            TextColor="White"
                            FontSize="16"
                            FontAttributes="Bold"
                            CornerRadius="10"
                            HeightRequest="50"
                            Margin="0,10,0,0"
                            Command="{Binding LoginCommand}"
                            IsEnabled="{Binding IsLoading, Converter={StaticResource InvertedBoolConverter}}"
                            IsVisible="{Binding IsLoading, Converter={StaticResource InvertedBoolConverter}}" />

                    <!-- Loading Indicator -->
                    <ActivityIndicator IsRunning="{Binding IsLoading}"
                                       IsVisible="{Binding IsLoading}"
                                       Color="#3498DB"
                                       HeightRequest="50"
                                       Margin="0,10,0,0" />

                </VerticalStackLayout>
            </Grid>
        </ScrollView>

        <!-- Overlay khi loading -->
        <BoxView BackgroundColor="#80000000"
                 IsVisible="{Binding IsLoading}"
                 InputTransparent="False" />
    </Grid>
</ContentPage>